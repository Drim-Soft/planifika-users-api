# Configuración de pruebas con base de datos real
spring.application.name=planifikausersapi-test

# ===============================
# DATABASE - Supabase PostgreSQL (Planifika) - REAL
# ===============================
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USER}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.hibernate.ddl-auto=none
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl

spring.datasource.hikari.data-source-properties.prepareThreshold=0
spring.datasource.hikari.data-source-properties.cachePrepStmts=false
spring.datasource.hikari.data-source-properties.preferQueryMode=simple
spring.datasource.hikari.data-source-properties.autosave=always

spring.datasource.hikari.maximumPoolSize=5
spring.datasource.hikari.minIdle=2
spring.datasource.hikari.idleTimeout=300000
spring.datasource.hikari.maxLifetime=600000
spring.datasource.hikari.connectionTimeout=30000
spring.datasource.hikari.validationTimeout=3000

# ===============================
# DATABASE - Supabase PostgreSQL SIU - REAL
# Usar las mismas credenciales de Planifika si no hay SIU separado
# ===============================
spring.datasource.siu.url=${DB_URL_SIU:${DB_URL}}
spring.datasource.siu.username=${DB_USER_SIU:${DB_USER}}
spring.datasource.siu.password=${DB_PASSWORD_SIU:${DB_PASSWORD}}
spring.datasource.siu.driver-class-name=org.postgresql.Driver

spring.jpa.siu.hibernate.ddl-auto=none
spring.jpa.siu.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.PhysicalNamingStrategyStandardImpl
spring.datasource.siu.hikari.data-source-properties.prepareThreshold=0
spring.datasource.siu.hikari.data-source-properties.cachePrepStmts=false
spring.datasource.siu.hikari.data-source-properties.preferQueryMode=simple
spring.datasource.siu.hikari.data-source-properties.autosave=always
spring.datasource.siu.hikari.connectionTimeout=30000
spring.datasource.siu.hikari.initializationFailTimeout=-1

# ===============================
# DATABASE - Drimsoft PostgreSQL (opcional para pruebas)
# ===============================
drimsoft.datasource.url=${DRIMSOFT_DB_URL:${DB_URL}}
drimsoft.datasource.username=${DRIMSOFT_DB_USER:${DB_USER}}
drimsoft.datasource.password=${DRIMSOFT_DB_PASSWORD:${DB_PASSWORD}}
drimsoft.datasource.driver-class-name=org.postgresql.Driver
drimsoft.datasource.hikari.data-source-properties.prepareThreshold=0
drimsoft.datasource.hikari.data-source-properties.cachePrepStmts=false
drimsoft.datasource.hikari.data-source-properties.preferQueryMode=simple
drimsoft.datasource.hikari.data-source-properties.autosave=always

# ===============================
# Supabase API (para consumo externo) - REAL
# ===============================
supabase.url=${SUPABASE_URL}
supabase.anon.key=${SUPABASE_ANON_KEY}
supabase.service.key=${SUPABASE_SERVICE_KEY}
supabase.jwt.secret=${SUPABASE_JWT_SECRET}

# ===============================
# Supabase API SIU (para consumo externo) - REAL
# ===============================
supabase.url.siu=${SUPABASE_URL_SIU}
supabase.anon.key.siu=${SUPABASE_ANON_KEY_SIU}
supabase.jwt.secret.siu=${SUPABASE_JWT_SECRET_SIU:}

# ===============================
# General Configuration
# ===============================
spring.docker.compose.enabled=false
spring.config.import=optional:file:.env[.properties]

# Desactivar seguridad para pruebas
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration

# Configuración de logging para pruebas
logging.level.org.springframework=INFO
logging.level.com.planifikausersapi=DEBUG
logging.level.org.springframework.boot.autoconfigure=WARN

# Permitir que las pruebas continúen aunque algunos beans fallen
spring.main.allow-bean-definition-overriding=true
spring.main.lazy-initialization=false
